\documentclass[10pt,journal,compsocconf]{IEEEtran}

\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{siunitx}
\usepackage{biblatex}
\usepackage{mathtools}
\usepackage[font=small]{caption}
\usepackage{subcaption}

\usepackage{fancyhdr}
\pagestyle{fancy}
\cfoot{\thepage}

\title{CS-454 Series \#5 (MPI) -- Fall 2023}
\author{
  Sepehr Mousavi (Sciper: 338673)
}
\date{\today}
\newcommand{\code}[1]{\texttt{#1}}

\begin{document}

\maketitle


1. Preliminary code cleaning
  - Using C++ stl
  - Improving IO
  - No change in the logic of the code

2. Profiling BH
  - time:
    - gprof: ~70\% on compute_force_particle + ~8\% insert_particle
    - perf: ~70\% on compute_force_in_node + ~12\% move_all_particles
  - cache misses: only 0.13\%
    
2. Profiling BF
  - time: not much can be inferred
  - cache misses: only 0.13\%


\section{Introduction}
...

\section{Implementations}
...

\subsection{SEQ}
- Only code cleaning + changing input arguments
- Base for the other parts

\subsection{MPI}
- nbody.cpp
  - ::main: MPI initialization and finalization
- barneshut.h
  - ::barneshut(, psize, prank)
- paramteters.h
  - ::particle.prank
  - ::particle.req
- reader.h and reader.cpp
  - ::read_test_case(, psize)
  - particle.prank = (id - 1) \% psize
  - particle.req = NULL
  - particle.buf_f;
- barneshut.cpp
  - compute_force_in_node(, int prank)
    - If particle.prank matches, compute and send+wait the calculations to all the other processes
    - Otherwise, post receive request from the corresponding process
  - move_all_particles(, int prank)
  - move_particle(, int prank)
      - If particle.prank matches, nothing
      - Otherwise, wait for the receive requests

\section{Results}
...

\section{Discussion}

IDEA 1: broadcast the computed forces for each particle to overlap with computation.
Fails on large problems because of SO MANY communications!

- Unlike hw5, it is not straightforward to overlap computation of forces with communication
  because the dependencies are universal (and not local).


\section{Reproducibility}
...

\section{Conclusion}
...

\end{document}
